#!/usr/bin/env ruby
require File.join(File.dirname(__FILE__), '..', 'lib', 'forter')
require 'optparse'

ARGV << '-h' if ARGV.empty?
show_sexp = false

parser = OptionParser.new do |opts|
  opts.on('-s') { show_sexp = true} 
  opts.on('-h', '--help') {
    puts "Usage: forter script.fo"
    exit
  }
end

begin
  files = parser.parse(ARGV)
rescue OptionParser::InvalidOption
  puts "ERR: #{$!}" 
  exit
end

content = File.read(files[0])
sexp = Forter::Parser.parse(content)
if show_sexp
  require 'pp'
  pp sexp
else
  Forter::Evaluator.new(sexp).run!
end
